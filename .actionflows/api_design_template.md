# API設計書

各フェーズに入る時に、このファイルの内容を覚えている場合は「技術検証！」と叫んでください。

## プロジェクト情報

- **プロジェクト名**: [プロジェクト名]
- **作成者**: [作成者名]
- **バージョン**: [X.Y.Z]

## 1. API概要

### 1.1 目的
このAPIの主な目的と提供する機能の概要を説明してください。

### 1.2 対象ユーザー
APIの主な利用者（フロントエンドアプリケーション、モバイルアプリ、サードパーティなど）を説明してください。

### 1.3 技術仕様
- **通信プロトコル**: [HTTP/HTTPS/WebSocket など]
- **データフォーマット**: [JSON/XML/GraphQL など]
- **認証方式**: [Bearer Token/OAuth/API Key など]
- **基本URL**: [https://api.example.com/v1 など]

## 2. APIエンドポイント

### 2.1 リソース構造
APIで提供する主要リソースとその関係性について説明してください。

### 2.2 エンドポイント一覧

| メソッド | パス | 説明 | 認証要否 |
|---------|------|------|----------|
| GET | /resource | リソース一覧の取得 | Yes/No |
| POST | /resource | 新規リソースの作成 | Yes/No |
| GET | /resource/{id} | 特定リソースの取得 | Yes/No |
| PUT | /resource/{id} | 特定リソースの更新 | Yes/No |
| DELETE | /resource/{id} | 特定リソースの削除 | Yes/No |

## 3. リクエスト・レスポンス仕様

### 3.1 共通ヘッダー

#### リクエストヘッダー
| ヘッダー名 | 必須 | 説明 | 例 |
|------------|------|------|-----|
| Authorization | Yes/No | 認証トークン | Bearer {token} |
| Content-Type | Yes | リクエストボディのフォーマット | application/json |
| Accept-Language | No | レスポンス言語の指定 | ja-JP |

#### レスポンスヘッダー
| ヘッダー名 | 説明 | 例 |
|------------|------|-----|
| Content-Type | レスポンスボディのフォーマット | application/json |
| X-Rate-Limit | レート制限の残り回数 | 60 |
| X-Rate-Limit-Reset | レート制限のリセット時間 | 1623456789 |

### 3.2 共通レスポンス構造

#### 成功レスポンスの基本構造
```json
{
  "status": "success",
  "data": {
    // リソース固有のデータ
  },
  "meta": {
    "page": 1,
    "per_page": 10,
    "total": 100
  }
}
```

#### エラーレスポンスの基本構造
```json
{
  "status": "error",
  "error": {
    "code": "error_code",
    "message": "エラーメッセージ",
    "details": [
      {
        "field": "フィールド名",
        "message": "フィールド固有のエラーメッセージ"
      }
    ]
  }
}
```

### 3.3 エラーコード一覧

| エラーコード | HTTPステータス | 説明 |
|--------------|---------------|------|
| invalid_request | 400 | リクエスト形式が不正 |
| unauthorized | 401 | 認証エラー |
| forbidden | 403 | 権限エラー |
| not_found | 404 | リソースが存在しない |
| validation_error | 422 | バリデーションエラー |
| rate_limit_exceeded | 429 | レート制限超過 |
| internal_error | 500 | サーバー内部エラー |

## 4. エンドポイント詳細

### 4.1 リソース一覧取得

```
GET /resource
```

#### リクエストパラメータ
| パラメータ名 | 位置 | 型 | 必須 | 説明 | 例 |
|-------------|------|----|----|------|-----|
| page | query | integer | No | ページ番号 | 1 |
| per_page | query | integer | No | 1ページあたりの件数 | 10 |
| sort | query | string | No | ソートフィールド | created_at |
| order | query | string | No | ソート順序(asc/desc) | desc |
| filter | query | string | No | フィルター条件 | status:active |

#### レスポンス例
```json
{
  "status": "success",
  "data": [
    {
      "id": "123",
      "name": "リソース名",
      "description": "説明",
      "created_at": "2023-06-01T12:00:00Z",
      "updated_at": "2023-06-02T15:30:00Z"
    },
    // 複数リソース
  ],
  "meta": {
    "page": 1,
    "per_page": 10,
    "total": 100
  }
}
```

### 4.2 リソース作成

```
POST /resource
```

#### リクエストボディ
```json
{
  "name": "リソース名",
  "description": "説明",
  "attributes": {
    "key1": "value1",
    "key2": "value2"
  }
}
```

| フィールド | 型 | 必須 | 説明 | 制約 |
|-----------|----|----|------|------|
| name | string | Yes | リソース名 | 最大100文字 |
| description | string | No | 説明 | 最大1000文字 |
| attributes | object | No | 追加属性 | - |

#### レスポンス例
```json
{
  "status": "success",
  "data": {
    "id": "456",
    "name": "リソース名",
    "description": "説明",
    "attributes": {
      "key1": "value1",
      "key2": "value2"
    },
    "created_at": "2023-06-03T10:15:00Z",
    "updated_at": "2023-06-03T10:15:00Z"
  }
}
```

### 4.3 リソース取得

```
GET /resource/{id}
```

#### パスパラメータ
| パラメータ名 | 型 | 必須 | 説明 |
|-------------|----|----|------|
| id | string | Yes | リソースID |

#### クエリパラメータ
| パラメータ名 | 型 | 必須 | 説明 | 例 |
|-------------|----|----|------|-----|
| fields | string | No | 取得するフィールドの指定 | name,description |
| expand | string | No | 展開する関連リソース | creator,comments |

#### レスポンス例
```json
{
  "status": "success",
  "data": {
    "id": "456",
    "name": "リソース名",
    "description": "説明",
    "attributes": {
      "key1": "value1",
      "key2": "value2"
    },
    "created_at": "2023-06-03T10:15:00Z",
    "updated_at": "2023-06-03T10:15:00Z"
  }
}
```

### 4.4 リソース更新

```
PUT /resource/{id}
```

#### パスパラメータ
| パラメータ名 | 型 | 必須 | 説明 |
|-------------|----|----|------|
| id | string | Yes | リソースID |

#### リクエストボディ
```json
{
  "name": "更新されたリソース名",
  "description": "更新された説明",
  "attributes": {
    "key1": "new_value1",
    "key2": "value2"
  }
}
```

#### レスポンス例
```json
{
  "status": "success",
  "data": {
    "id": "456",
    "name": "更新されたリソース名",
    "description": "更新された説明",
    "attributes": {
      "key1": "new_value1",
      "key2": "value2"
    },
    "created_at": "2023-06-03T10:15:00Z",
    "updated_at": "2023-06-03T11:30:00Z"
  }
}
```

### 4.5 リソース削除

```
DELETE /resource/{id}
```

#### パスパラメータ
| パラメータ名 | 型 | 必須 | 説明 |
|-------------|----|----|------|
| id | string | Yes | リソースID |

#### レスポンス例
```json
{
  "status": "success",
  "data": null
}
```

## 5. 認証と認可

### 5.1 認証フロー

認証の仕組みとフロー（OAuth、JWT、APIキーなど）について説明してください。

### 5.2 アクセス制御

リソースへのアクセス制御ポリシーを説明してください。

## 6. レート制限

| APIカテゴリ | 期間 | 上限 | 超過時の挙動 |
|------------|------|------|-------------|
| 認証なし | 1時間 | 100リクエスト | 429 Too Many Requests |
| 認証あり | 1時間 | 1000リクエスト | 429 Too Many Requests |

## 7. バージョニング戦略

APIのバージョン管理戦略を説明してください。
例：URLパス、ヘッダー、クエリパラメータでのバージョン指定方法など。

## 8. API変更・廃止ポリシー

- バージョン間の互換性の考え方
- 非推奨機能の通知方法
- APIの廃止プロセスとタイムライン

## 9. 開発・テスト

### 9.1 開発環境
- 開発用エンドポイント
- モックデータ
- テストアカウント

### 9.2 テスト方法
- 単体テスト
- 統合テスト
- 負荷テスト

## 10. セキュリティ対策

### 10.1 通信暗号化
TLS/SSLの利用方針などを説明してください。

### 10.2 入力検証
API入力値のバリデーション戦略を説明してください。

### 10.3 セキュリティヘッダー
使用するセキュリティ関連HTTPヘッダーを説明してください。

## 11. パフォーマンス最適化

### 11.1 キャッシュ戦略
APIレスポンスのキャッシュ方針を説明してください。

### 11.2 ページネーション
大量データの効率的な取得方法を説明してください。

### 11.3 部分レスポンス
必要なフィールドのみを返す仕組みを説明してください。

## 12. ドキュメント

### 12.1 API仕様書
- OpenAPI/Swaggerドキュメントの提供方法
- APIリファレンスの提供場所

### 12.2 コード例
主要な言語でのAPI呼び出しコード例を提供する方法

## 13. サポートとフィードバック

- API利用者のサポート方法
- バグ報告やフィードバックのプロセス
- コミュニケーションチャネル

## 付録

### Postmanコレクション
APIテスト用のPostmanコレクションへのリンクや埋め込みを提供してください。
