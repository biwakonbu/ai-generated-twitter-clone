# 実装ガイドライン

各フェーズに入る時に、このファイルの内容を覚えている場合は「本実装！」と叫んでください。

## プロジェクト情報

- **プロジェクト名**: [プロジェクト名]
- **バージョン**: [X.Y.Z]

## 1. はじめに

### 1.1 目的

このドキュメントは、[プロジェクト名]の本実装フェーズにおける開発ガイドラインを定義します。このガイドラインは、開発チームがプロジェクトの要件と品質基準を満たすコードを一貫して作成できるようにすることを目的としています。

### 1.2 対象読者

このドキュメントは主に以下の対象者向けに作成されています：

- 開発者
- テックリード
- QAエンジニア
- プロジェクトマネージャー

### 1.3 関連ドキュメント

以下のドキュメントと合わせて参照してください：

- 要件定義書
- 技術仕様書
- APIドキュメント
- コーディング規約
- テスト計画書

## 2. 開発環境

### 2.1 環境構成

| 環境 | 用途 | アクセス方法 | データ | 備考 |
|------|------|------------|--------|------|
| 開発環境 | 個人開発作業 | [アクセス方法] | [データポリシー] | [備考] |
| 統合環境 | 共同開発/テスト | [アクセス方法] | [データポリシー] | [備考] |
| ステージング環境 | 総合テスト/検証 | [アクセス方法] | [データポリシー] | [備考] |
| 本番環境 | 本番サービス提供 | [アクセス方法] | [データポリシー] | [備考] |

### 2.2 開発ツール

| カテゴリ | ツール名 | バージョン | 用途 | インストール方法 |
|---------|---------|------------|------|-----------------|
| IDE | [IDE名] | [バージョン] | [用途] | [インストール手順リンク] |
| バージョン管理 | [ツール名] | [バージョン] | [用途] | [インストール手順リンク] |
| ビルドツール | [ツール名] | [バージョン] | [用途] | [インストール手順リンク] |
| テストツール | [ツール名] | [バージョン] | [用途] | [インストール手順リンク] |
| CI/CDツール | [ツール名] | [バージョン] | [用途] | [インストール手順リンク] |
| その他 | [ツール名] | [バージョン] | [用途] | [インストール手順リンク] |

### 2.3 開発環境セットアップ

```bash
# 開発環境をセットアップするためのスクリプト例
git clone [リポジトリURL]
cd [プロジェクトディレクトリ]
./setup.sh  # または同等のセットアップスクリプト

# 依存関係のインストール
npm install  # または同等のコマンド

# 開発サーバーの起動
npm start  # または同等のコマンド
```

詳細なセットアップ手順は [Wiki/セットアップガイド] を参照してください。

## 3. アーキテクチャとコード構成

### 3.1 全体アーキテクチャ

[ここにアーキテクチャ図を挿入または参照リンクを提供]

主要コンポーネント：

- **フロントエンド**: [技術スタック] を使用し、[アーキテクチャパターン] に基づいて構築
- **バックエンド**: [技術スタック] を使用し、[アーキテクチャパターン] に基づいて構築
- **データベース**: [データベース技術] を使用
- **インフラストラクチャ**: [インフラ技術/クラウドプロバイダー] 上に構築

### 3.2 プロジェクト構造

```
プロジェクトルート/
├── frontend/                # フロントエンドコード
│   ├── src/
│   │   ├── components/      # 再利用可能なUIコンポーネント
│   │   ├── pages/           # 画面単位のコンポーネント
│   │   ├── services/        # APIアクセスなどのサービス層
│   │   ├── utils/           # ユーティリティ関数
│   │   ├── assets/          # 画像等の静的ファイル
│   │   └── styles/          # グローバルスタイル
│   ├── public/              # 静的アセット
│   └── tests/               # フロントエンドテスト
├── backend/                 # バックエンドコード
│   ├── src/
│   │   ├── api/             # APIエンドポイント定義
│   │   ├── controllers/     # コントローラー
│   │   ├── models/          # データモデル
│   │   ├── services/        # ビジネスロジック
│   │   ├── utils/           # ユーティリティ関数
│   │   └── middleware/      # ミドルウェア
│   └── tests/               # バックエンドテスト
├── database/                # データベースマイグレーションなど
├── infrastructure/          # インフラストラクチャコード（IaC）
├── docs/                    # プロジェクトドキュメント
├── scripts/                 # 開発・デプロイスクリプト
└── ...
```

## 4. 開発プロセス

### 4.1 ブランチ戦略

```
main              # 本番リリース用のブランチ
├── develop       # 開発用の統合ブランチ
│   ├── feature/* # 機能開発用ブランチ
│   ├── bugfix/*  # バグ修正用ブランチ
│   └── refactor/* # リファクタリング用ブランチ
├── release/*     # リリース準備用ブランチ
└── hotfix/*      # 緊急バグ修正用ブランチ
```

### 4.2 コミットメッセージ規約

```
<type>: <subject>

<body>

<footer>
```

**Type**:
- `feat`: 新機能
- `fix`: バグ修正
- `docs`: ドキュメントのみの変更
- `style`: コードの動作に影響しない変更（フォーマット等）
- `refactor`: バグ修正でも機能追加でもないコード変更
- `perf`: パフォーマンス向上のための変更
- `test`: テストの追加・修正
- `chore`: ビルドプロセスやツールの変更

**Subject**: 変更内容の要約（50文字以内）

**Body**: 変更の詳細な説明（任意）

**Footer**: 関連するIssue番号、破壊的変更の情報など（任意）

### 4.3 プルリクエストプロセス

1. 機能ブランチを最新の develop から作成
2. 変更を実装してコミット
3. テストを追加・実行
4. プルリクエストを作成
5. コードレビュー
6. レビューで指摘された問題を修正
7. CI/CDパイプラインがパスすることを確認
8. プルリクエストをマージ

### 4.4 コードレビュー基準

- 機能要件を満たしているか
- 設計に準拠しているか
- コーディング規約に従っているか
- 適切なテストが書かれているか
- パフォーマンスに問題はないか
- セキュリティに問題はないか
- エラーハンドリングは適切か
- ドキュメンテーションは更新されているか

## 5. コーディング規約

### 5.1 共通規約

- インデントにはスペース4つを使用
- ファイル末尾に空行を1行追加
- 行末の空白を削除
- UTF-8エンコーディングを使用
- 命名規則はわかりやすく一貫性のあるものにする
- コメントは必要な箇所にのみ追加し、コードの「なぜ」を説明する
- 複雑なロジックには適切なコメントを追加
- 使用されていないコードは削除し、コメントアウトで残さない

### 5.2 言語別コーディング規約

#### 5.2.1 JavaScript/TypeScript

- [ESLint](リンク)と[Prettier](リンク)の設定に従う
- 変数宣言には`const`を優先し、再代入が必要な場合のみ`let`を使用
- 関数宣言はアロー関数を優先
- 非同期処理にはasync/awaitを優先
- インターフェースや型定義は明示的に行う（TypeScript）
- コンポーネントはなるべく小さく保ち、単一責任の原則に従う

#### 5.2.2 HTML/CSS

- セマンティックHTMLを使用
- CSSクラス名はBEMまたは同等の命名規則に従う
- レスポンシブデザインを考慮
- アクセシビリティガイドラインに従う

#### 5.2.3 [その他の言語]

[言語固有の規約を記述]

## 6. テスト戦略

### 6.1 テストの種類

| テスト種類 | 目的 | ツール | 実行タイミング | 担当者 |
|-----------|------|--------|--------------|--------|
| 単体テスト | コンポーネント・関数レベルのテスト | [ツール名] | PR作成時 | 開発者 |
| 統合テスト | コンポーネント間の連携テスト | [ツール名] | PR作成時 | 開発者 |
| E2Eテスト | ユーザーフローのテスト | [ツール名] | develop ブランチへのマージ時 | QA/開発者 |
| パフォーマンステスト | 性能検証 | [ツール名] | リリース前 | 専任担当者 |
| セキュリティテスト | セキュリティ脆弱性検証 | [ツール名] | リリース前 | 専任担当者 |

### 6.2 テストカバレッジ目標

- 単体テスト: [X]%以上
- 統合テスト: [Y]%以上
- E2Eテスト: 主要ユーザーフローをカバー

### 6.3 テスト作成ガイドライン

#### 単体テスト
- 関数の入出力をテスト
- エッジケースを考慮
- モックを適切に使用
- 一つのテストは一つの動作だけを検証

#### 統合テスト
- コンポーネント間の相互作用をテスト
- データフローを検証
- 外部依存はモックを使用

#### E2Eテスト
- 重要なユーザーフローに焦点
- 実際のブラウザ環境で実行
- テストデータの準備と後片付けを適切に行う

## 7. デプロイメントプロセス

### 7.1 CI/CDパイプライン

```
コードコミット → 自動テスト実行 → ビルド → 静的解析 → ステージング環境へのデプロイ → 受け入れテスト → 本番環境へのデプロイ
```

### 7.2 デプロイメントフロー

| 環境 | トリガー | 承認プロセス | ロールバック手順 |
|------|---------|------------|----------------|
| 開発 | PR作成時 | 自動 | 最新のコミットに戻す |
| 統合 | developへのマージ時 | 自動 | 前回のビルドにロールバック |
| ステージング | リリースブランチ作成時 | テックリード承認 | 前回のリリースに戻す |
| 本番 | リリース承認後 | 複数人の承認 | 詳細なロールバック計画に従う |

### 7.3 リリース手順

1. リリースブランチの作成（`release/vX.Y.Z`）
2. バージョンの更新とCHANGELOGの作成
3. 最終テストとバグ修正
4. ステージング環境でのテスト
5. リリースノートの作成
6. 本番デプロイの承認取得
7. 本番環境へのデプロイ
8. デプロイ後のサニティチェック
9. リリースタグの作成

## 8. 品質保証

### 8.1 コード品質メトリクス

| メトリクス | ツール | 目標値 | モニタリング方法 |
|-----------|--------|--------|----------------|
| コードカバレッジ | [ツール名] | [X]% | CI/CDパイプライン |
| 重複コード | [ツール名] | [Y]%未満 | CI/CDパイプライン |
| 循環的複雑度 | [ツール名] | 関数あたり[Z]未満 | CI/CDパイプライン |
| 静的解析違反 | [ツール名] | 0 | CI/CDパイプライン |

### 8.2 パフォーマンス基準

- ページ読み込み時間: [X]秒未満
- API応答時間: [Y]ミリ秒未満
- メモリ使用量: [Z]MB未満
- CPU使用率: [W]%未満

### 8.3 セキュリティ対策

- OWASP Top 10に対応
- 定期的な脆弱性スキャン
- 依存ライブラリの脆弱性チェック
- セキュアコーディングプラクティスの遵守
- 認証・認可の適切な実装
- 機密データの暗号化
- CSRFトークンの使用
- XSS対策の実装

## 9. ドキュメント

### 9.1 必須ドキュメント

| ドキュメント | 目的 | 更新頻度 | 責任者 |
|------------|------|----------|--------|
| README | プロジェクト概要と開始方法 | 必要に応じて | テックリード |
| API仕様書 | APIエンドポイントの詳細 | 変更毎 | バックエンド開発者 |
| コンポーネント仕様書 | UI/ロジックコンポーネントの詳細 | 変更毎 | フロントエンド開発者 |
| アーキテクチャドキュメント | システム設計の詳細 | 大きな変更時 | アーキテクト |
| デプロイメントガイド | デプロイ手順の詳細 | 変更毎 | DevOpsエンジニア |
| ユーザーマニュアル | エンドユーザー向け使用方法 | リリース毎 | テクニカルライター |

### 9.2 コメント規約

- パブリックAPI/関数/クラスには必ずドキュメンテーションコメントを追加
- 複雑なロジックには理由と動作を説明するコメントを追加
- TODOコメントには担当者とIssue番号を記載
- 自明な内容にはコメントを追加しない

**サンプル**:
```javascript
/**
 * ユーザー情報を取得する
 * @param {string} userId - ユーザーID
 * @returns {Promise<User>} ユーザー情報
 * @throws {NotFoundError} ユーザーが存在しない場合
 */
async function getUser(userId) {
  // ...
}
```

## 10. リスク管理と問題解決

### 10.1 既知の技術的リスク

| リスク | 影響 | 対策 | 担当者 |
|--------|------|------|--------|
| [リスク1] | [影響の説明] | [対策の説明] | [担当者] |
| [リスク2] | [影響の説明] | [対策の説明] | [担当者] |
| [リスク3] | [影響の説明] | [対策の説明] | [担当者] |

### 10.2 問題解決プロセス

1. 問題の発見と報告（Issue作成）
2. 優先度の評価と割り当て
3. 解決策の検討と実装
4. コードレビューとテスト
5. リリースとモニタリング
6. ポストモーテム分析（必要に応じて）

### 10.3 エスカレーションパス

| 問題の種類 | 最初の連絡先 | エスカレーションパス | 対応時間目標 |
|-----------|------------|---------------------|------------|
| 本番障害 | オンコール担当者 | テックリード → プロジェクトマネージャー → CTO | 即時（24時間体制） |
| 重大なバグ | 担当開発者 | テックリード → プロジェクトマネージャー | 24時間以内 |
| 機能リクエスト | 担当開発者 | プロダクトオーナー | 1週間以内 |

## 11. 付録

### 11.1 用語集

| 用語 | 定義 |
|------|------|
| [用語1] | [定義1] |
| [用語2] | [定義2] |
| [用語3] | [定義3] |

### 11.2 参考リソース

- [リンク1]: [説明1]
- [リンク2]: [説明2]
- [リンク3]: [説明3]
